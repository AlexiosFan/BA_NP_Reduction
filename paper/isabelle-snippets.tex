\usepackage{ifthen}
\usepackage{/home/zixuan/Isabelle2022_linux/Isabelle2022/lib/texinputs/isabelle}
\usepackage{/home/zixuan/Isabelle2022_linux/Isabelle2022/lib/texinputs/isabellesym}
\isabellestyle{tt}
 
\newcommand{\DefineSnippet}[2]{%
  \expandafter\newcommand\csname snippet--#1\endcsname{%
    \begin{quote}
    \begin{isabelle}
    #2
    \end{isabelle}
    \end{quote}}}
\newcommand{\Snippet}[1]{%
  \ifcsname snippet--#1\endcsname{\csname snippet--#1\endcsname}%
  \else+++++++ERROR: Snippet ``#1 not defined+++++++ \fi}

\DefineSnippet{cnf-sat-def}{
    %
\begin{isabelle}%
    \isacommand{datatype}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ lit\ {\isacharequal}{\kern0pt}\ Pos\ {\isacharprime}{\kern0pt}a\ {\isacharbar}{\kern0pt}\ Neg\ {\isacharprime}{\kern0pt}a\isanewline
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ three{\isacharunderscore}{\kern0pt}sat\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lit\ set\ list{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ lift\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ lit\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isasymup}{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}lift\ {\isasymsigma}\ {\isasymequiv}\ {\isasymlambda}l{\isachardot}{\kern0pt}\ case\ l\ of\ Pos\ x\ {\isasymRightarrow}\ {\isasymsigma}\ x\ {\isacharbar}{\kern0pt}\ Neg\ x\ {\isasymRightarrow}\ {\isasymnot}\ {\isasymsigma}\ x{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ models\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ three{\isacharunderscore}{\kern0pt}sat\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixl}\ {\isachardoublequoteopen}{\isasymTurnstile}{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}{\isasymsigma}\ {\isasymTurnstile}\ F\ {\isasymequiv}\ {\isasymforall}cls\ {\isasymin}\ set\ F{\isachardot}{\kern0pt}\ {\isasymexists}l\ {\isasymin}\ cls{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymsigma}{\isasymup}{\isacharparenright}{\kern0pt}\ l{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ sat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ three{\isacharunderscore}{\kern0pt}sat\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}sat\ F\ {\isasymequiv}\ {\isasymexists}{\isasymsigma}{\isachardot}{\kern0pt}\ {\isasymsigma}\ {\isasymTurnstile}\ F{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
     {\isachardoublequoteopen}cnf{\isacharunderscore}{\kern0pt}sat\ {\isasymequiv}\ 
     {\isacharbraceleft}{\kern0pt}F{\isachardot}{\kern0pt}\ sat\ F\ {\isasymand}\ 
     {\isacharparenleft}{\kern0pt}{\isasymforall}cls\ {\isasymin}\ set\ F{\isachardot}{\kern0pt}\ 
     finite\ cls{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}%
\end{isabelle}
}

\DefineSnippet{exact-cover-original}{
    \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}exact{\isacharunderscore}{\kern0pt}cover\ {\isasymequiv}\ \isanewline
\ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ finite\ X\ {\isasymand}\ {\isasymUnion}S\ {\isasymsubseteq}\ X\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymexists}S{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ S{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ X{\isachardot}{\kern0pt}\ {\isasymexists}s\ {\isasymin}\ S{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymin}\ s\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}t\ {\isasymin}\ S{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ s\ {\isasymnoteq}\ t\ {\isasymlongrightarrow}\ x\ {\isasymnotin}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}
}

\DefineSnippet{exact-cover-def}{
    \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}exact{\isacharunderscore}{\kern0pt}cover\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ finite\ X\ {\isasymand}\ {\isasymUnion}S\ {\isasymsubseteq}\ X\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymexists}S{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ S{\isachardot}{\kern0pt}\ {\isasymUnion}S{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X\ {\isasymand}\ disjoint\ S{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}

}

\DefineSnippet{exact-cover-basics}{
    \isacommand{datatype}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ xc{\isacharunderscore}{\kern0pt}element\ {\isacharequal}{\kern0pt}\ V\ {\isacharprime}{\kern0pt}a\ {\isacharbar}{\kern0pt}\ C\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lit\ set{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ L\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lit{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lit\ set{\isachardoublequoteclose}
}

\DefineSnippet{exact-cover-red}{
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}comp{\isacharunderscore}{\kern0pt}X\ F\ {\isasymequiv}\ \isanewline
\ \ vars{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}sat\ F\ {\isasymunion}\ clauses{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}sat\ F\ {\isasymunion}\ literals{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}sat\ F{\isachardoublequoteclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}comp{\isacharunderscore}{\kern0pt}S\ F\ {\isasymequiv}\ \isanewline
\ \ \ \ literal{\isacharunderscore}{\kern0pt}sets\ F\ {\isasymunion}\ clauses{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}literals\ F\ \isanewline
\ \ {\isasymunion}\ var{\isacharunderscore}{\kern0pt}true{\isacharunderscore}{\kern0pt}literals\ F\ {\isasymunion}\ var{\isacharunderscore}{\kern0pt}false{\isacharunderscore}{\kern0pt}literals\ F{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ sat{\isacharunderscore}{\kern0pt}xc\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ three{\isacharunderscore}{\kern0pt}sat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ xc{\isacharunderscore}{\kern0pt}element\ set\ {\isacharasterisk}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ xc{\isacharunderscore}{\kern0pt}element\ set\ set{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
{\isachardoublequoteopen}sat{\isacharunderscore}{\kern0pt}xc\ F\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}comp{\isacharunderscore}{\kern0pt}X\ F{\isacharcomma}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}S\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}
}

\DefineSnippet{exact-cover-prf}{
    \isacommand{definition}\isamarkupfalse%
\ constr{\isacharunderscore}{\kern0pt}cover{\isacharunderscore}{\kern0pt}clause\isanewline
\ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lit\ set\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ xc{\isacharunderscore}{\kern0pt}element\ set\ set{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
{\isachardoublequoteopen}constr{\isacharunderscore}{\kern0pt}cover{\isacharunderscore}{\kern0pt}clause\ c\ {\isasymsigma}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}SOME\ s{\isachardot}{\kern0pt}\ {\isasymexists}p\ {\isasymin}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymsigma}{\isasymup}{\isacharparenright}{\kern0pt}\ p\ {\isasymand}\ s\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}C\ c{\isacharcomma}{\kern0pt}\ L\ p\ c{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}L\ q\ c{\isacharbraceright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ q{\isachardot}{\kern0pt}\ q\ {\isasymin}\ c\ {\isasymand}\ q\ {\isasymnoteq}\ p\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymsigma}{\isasymup}{\isacharparenright}{\kern0pt}\ q{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ constr{\isacharunderscore}{\kern0pt}cover{\isacharunderscore}{\kern0pt}clause{\isacharunderscore}{\kern0pt}unfold{\isacharcolon}{\kern0pt}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymsigma}\ {\isasymTurnstile}\ F{\isachardoublequoteclose}\ {\isachardoublequoteopen}c\ {\isasymin}\ set\ F{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}p{\isasymin}c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymsigma}{\isasymup}{\isacharparenright}{\kern0pt}\ p\ {\isasymand}\ constr{\isacharunderscore}{\kern0pt}cover{\isacharunderscore}{\kern0pt}clause\ c\ {\isasymsigma}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}C\ c{\isacharcomma}{\kern0pt}\ L\ p\ c{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}L\ q\ c{\isacharbraceright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ q{\isachardot}{\kern0pt}\ q\ {\isasymin}\ c\ {\isasymand}\ q\ {\isasymnoteq}\ p\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymsigma}{\isasymup}{\isacharparenright}{\kern0pt}\ q{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}
}

\DefineSnippet{exact-cover-correct}{ 
\isacommand{theorem}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}reduction{\isacharunderscore}{\kern0pt}sat{\isacharunderscore}{\kern0pt}xc{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}reduction\ sat{\isacharunderscore}{\kern0pt}xc\ cnf{\isacharunderscore}{\kern0pt}sat\ exact{\isacharunderscore}{\kern0pt}cover{\isachardoublequoteclose}
}

\DefineSnippet{exact-cover-poly}{
    \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}sat{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}alg{\kern0pt}\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}F{\isachardot}{\kern0pt}\isanewline
\ do\ \isanewline
\ \ \ \ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ VS\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}sat\ F{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ CS\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}clauses{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}sat\ F{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ LS\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}literals{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}sat\ F{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ s{\isadigit{1}}\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}literal{\isacharunderscore}{\kern0pt}sets\ F{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ s{\isadigit{2}}\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}clauses{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}literals\ F{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ s{\isadigit{3}}\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}var{\isacharunderscore}{\kern0pt}true{\isacharunderscore}{\kern0pt}literals\ F{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ s{\isadigit{4}}\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}var{\isacharunderscore}{\kern0pt}false{\isacharunderscore}{\kern0pt}literals\ F{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ X\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}x\ CS\ VS\ LS{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ S\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}s\ s{\isadigit{1}}\ s{\isadigit{2}}\ s{\isadigit{3}}\ s{\isadigit{4}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ RETURNT\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}\isanewline
{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}sat{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}time{\isacharunderscore}{\kern0pt}aux{\kern0pt}\ l\ m\ n\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\isanewline
{\isacharplus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\isanewline
{\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ m\isanewline
{\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\isanewline
{\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\isanewline
{\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}sat{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}aux{\kern0pt}\ l\ m\ n\ {\isacharequal}{\kern0pt}\ \isanewline
l\ {\isacharplus}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ n\isanewline
{\isacharplus}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ n\isanewline
{\isacharplus}{\kern0pt}\ l\ {\isacharplus}{\kern0pt}\ l{\isachardoublequoteclose}
}

\DefineSnippet{exact-cover-polyaux}{
    \isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}a\ {\isasymunion}\ b\ {\isasymunion}\ c\ {\isasymunion}\ d{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ a\ {\isacharplus}{\kern0pt}\ card\ b\ {\isacharplus}{\kern0pt}\ card\ c\ {\isacharplus}{\kern0pt}\ card\ d{\isachardoublequoteclose}
}

\DefineSnippet{exact-cover-final}{
\isacommand{lemma}\isamarkupfalse%
\ sat{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}size{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}size{\isacharunderscore}{\kern0pt}XC\ {\isacharparenleft}{\kern0pt}sat{\isacharunderscore}{\kern0pt}xc\ F{\isacharparenright}{\kern0pt}\ {\isasymle}\ sat{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}space\ {\isacharparenleft}{\kern0pt}size{\isacharunderscore}{\kern0pt}SAT{\isacharunderscore}{\kern0pt}max\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sat{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}refines{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}sat{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}alg\ F\ {\isasymle}\ \isanewline
\ \ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}y{\isachardot}{\kern0pt}\ y\ {\isacharequal}{\kern0pt}\ sat{\isacharunderscore}{\kern0pt}xc\ F{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ sat{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}time\ {\isacharparenleft}{\kern0pt}size{\isacharunderscore}{\kern0pt}SAT{\isacharunderscore}{\kern0pt}max\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}reduction{\isacharunderscore}{\kern0pt}sat{\isacharunderscore}{\kern0pt}xc{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}reduction\ sat{\isacharunderscore}{\kern0pt}xc\ cnf{\isacharunderscore}{\kern0pt}sat\ exact{\isacharunderscore}{\kern0pt}cover{\isachardoublequoteclose}

}

\DefineSnippet{exact-hitting-set-def}{
    \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}exact{\isacharunderscore}{\kern0pt}hitting{\isacharunderscore}{\kern0pt}set\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}S{\isachardot}{\kern0pt}\ {\isasymexists}W{\isachardot}{\kern0pt}\ finite\ W\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}s\ {\isasymin}\ S{\isachardot}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}W\ {\isasyminter}\ s{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}
}

\DefineSnippet{exact-hitting-set-reduction}{
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs\ {\isasymequiv}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ finite\ X\ {\isasymand}\ {\isasymUnion}S\ {\isasymsubseteq}\ X\ then\ {\isacharbraceleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}s{\isachardot}{\kern0pt}\ u\ {\isasymin}\ s\ {\isasymand}\ s\ {\isasymin}\ S{\isacharbraceright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ u{\isachardot}{\kern0pt}\ u\ {\isasymin}\ X{\isacharbraceright}{\kern0pt}\ else\ {\isacharbraceleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline

\isacommand{theorem}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}reduction{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}reduction\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs\ exact{\isacharunderscore}{\kern0pt}cover\ exact{\isacharunderscore}{\kern0pt}hitting{\isacharunderscore}{\kern0pt}set{\isachardoublequoteclose}
}

\DefineSnippet{exact-hitting-set-poly}{
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}alg\ {\isasymequiv}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
    \ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
    \ \ \ \ b\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}check{\isacharunderscore}{\kern0pt}finiteness{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}collection\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
    \ \ \ \ if\ b\ \isanewline
    \ \ \ \ then\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
    \ \ \ \ \ \ S{\isacharprime}{\kern0pt}\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}construct{\isacharunderscore}{\kern0pt}sets\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
    \ \ \ \ \ \ RETURNT\ S{\isacharprime}{\kern0pt}\isanewline
    \ \ \ \ {\isacharbraceright}{\kern0pt}\isanewline
    \ \ \ \ else\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
    \ \ \ \ \ \ RETURNT\ {\isacharbraceleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\isanewline
    \ \ \ \ {\isacharbraceright}{\kern0pt}\isanewline
    \ \ {\isacharbraceright}{\kern0pt}\isanewline
    {\isachardoublequoteclose}\isanewline
    \isanewline
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}space\ n\ {\isasymequiv}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ n{\isacharasterisk}{\kern0pt}n{\isachardoublequoteclose}\isanewline
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}time\ n\ {\isasymequiv}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharasterisk}{\kern0pt}\ n{\isachardoublequoteclose}\isanewline

    \isacommand{lemma}\isamarkupfalse%
\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}size{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}size{\isacharunderscore}{\kern0pt}ehs\ {\isacharparenleft}{\kern0pt}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs\ xc{\isacharparenright}{\kern0pt}\ {\isasymle}\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}space\ {\isacharparenleft}{\kern0pt}size{\isacharunderscore}{\kern0pt}XC\ xc{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isacommand{lemma}\isamarkupfalse%
\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}refines{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}alg\ xc\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}y{\isachardot}{\kern0pt}\ y\ {\isacharequal}{\kern0pt}\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs\ xc{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}time\ {\isacharparenleft}{\kern0pt}size{\isacharunderscore}{\kern0pt}XC\ xc{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}
%
}

\DefineSnippet{exact-hitting-set-aux}{
    \isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}le{\isacharcolon}{\kern0pt}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}finite\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}card\ X\ {\isasymle}\ Y{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharbraceleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}s{\isachardot}{\kern0pt}\ u\ {\isasymin}\ s\ {\isasymand}\ s\ {\isasymin}\ S{\isacharbraceright}{\kern0pt}\ {\isacharbar}{\kern0pt}u{\isachardot}{\kern0pt}\ u\ {\isasymin}\ X{\isacharbraceright}{\kern0pt}\ {\isasymle}\ Suc\ {\isacharparenleft}{\kern0pt}Y\ {\isacharasterisk}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}
%
}

\DefineSnippet{exact-hitting-set-final}{
    \isacommand{theorem}\isamarkupfalse%
\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}polyred{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}ispolyred\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ehs{\isacharunderscore}{\kern0pt}alg\ exact{\isacharunderscore}{\kern0pt}cover\ exact{\isacharunderscore}{\kern0pt}hitting{\isacharunderscore}{\kern0pt}set\ size{\isacharunderscore}{\kern0pt}XC\ size{\isacharunderscore}{\kern0pt}ehs{\isachardoublequoteclose}
}

\DefineSnippet{subset-sum-def}{
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}sum\ SS\ {\isasymequiv}\ \isanewline
    \ \ {\isacharparenleft}{\kern0pt}case\ SS\ of\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sum\ w\ S\ {\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
    \isanewline
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}subset{\isacharunderscore}{\kern0pt}sum\ {\isasymequiv}\ \isanewline
    \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ S\ w\ B{\isachardot}{\kern0pt}\ finite\ S\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymexists}S{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ S{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}sum\ {\isacharparenleft}{\kern0pt}S{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
    %
    \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nat\ X\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}SOME\ f{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ X\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ then\ bij{\isacharunderscore}{\kern0pt}betw\ f\ X\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ else\ bij{\isacharunderscore}{\kern0pt}betw\ f\ X\ {\isacharbraceleft}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}card\ X{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ p\ X\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ p\ {\isacharcircum}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ \ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ \isanewline
{\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss\ XC\ {\isasymequiv}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}case\ XC\ of\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}if\ infinite\ X\ {\isasymor}\ {\isacharparenleft}{\kern0pt}{\isasymnot}\ {\isasymUnion}S\ {\isasymsubseteq}\ X{\isacharparenright}{\kern0pt}\ then\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ card{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ else\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}let\ f\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nat\ X{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ p\ {\isacharequal}{\kern0pt}\ max\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}card\ S\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ in\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}A{\isachardot}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}weight\ p\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}weight\ p\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}
}

\DefineSnippet{subset-sum-aux1}{
    \isacommand{lemma}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}poly{\isacharcolon}{\kern0pt}\isanewline
\isakeyword{fixes}\ X{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ set{\isachardoublequoteclose}\ \isakeyword{and}\ p{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ {\isachardoublequoteopen}weight\ p\ X\ {\isacharequal}{\kern0pt}\ {\isasymSum}{\isacharbraceleft}{\kern0pt}p\ {\isacharcircum}{\kern0pt}\ x\ {\isacharbar}{\kern0pt}\ x\ {\isachardot}{\kern0pt}\ x\ {\isasymin}\ X{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}
}

\DefineSnippet{subset-sum-aux2}{
    \isacommand{theorem}\isamarkupfalse%
\ seq{\isacharunderscore}{\kern0pt}uniqueness{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ m\ j\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\ \isakeyword{and}\ D\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}eventually{\isacharunderscore}{\kern0pt}zero\ D{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}m\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isachardot}{\kern0pt}\ D\ i\ {\isacharasterisk}{\kern0pt}\ b{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ D\ i\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}D\ j\ {\isacharequal}{\kern0pt}\ ith{\isacharunderscore}{\kern0pt}digit\ m\ j{\isachardoublequoteclose}
}

\DefineSnippet{subset-sum-aux3}{
    \isacommand{theorem}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}reduction{\isacharunderscore}{\kern0pt}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}reduction\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss\ exact{\isacharunderscore}{\kern0pt}cover\ subset{\isacharunderscore}{\kern0pt}sum{\isachardoublequoteclose}
}

\DefineSnippet{subset-sum-poly}{

\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}alg\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ b\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}check{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}collection\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ if\ b\isanewline
\ \ \ \ then\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ RETURNT\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \ card{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ else\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ f\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}constr{\isacharunderscore}{\kern0pt}bij{\isacharunderscore}{\kern0pt}mapping\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ p\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}constr{\isacharunderscore}{\kern0pt}base\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ w\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}constr{\isacharunderscore}{\kern0pt}weight\ p\ f{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ B\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}constr{\isacharunderscore}{\kern0pt}B\ p\ f\ X{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ RETURNT\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}\isanewline
{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}space\ n\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}time\ n\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\isanewline 
\isacommand{lemma}\isamarkupfalse%
\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}size{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}size{\isacharunderscore}{\kern0pt}SS\ {\isacharparenleft}{\kern0pt}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}space\ {\isacharparenleft}{\kern0pt}size{\isacharunderscore}{\kern0pt}XC\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline

\isanewline
\isacommand{lemma}\isamarkupfalse%
\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}refines{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}alg\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}y{\isachardot}{\kern0pt}\ y\ {\isacharequal}{\kern0pt}\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}time\ {\isacharparenleft}{\kern0pt}size{\isacharunderscore}{\kern0pt}XC\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}ispolyred{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}ispolyred\ xc{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}alg\ exact{\isacharunderscore}{\kern0pt}cover\ subset{\isacharunderscore}{\kern0pt}sum\ size{\isacharunderscore}{\kern0pt}XC\ size{\isacharunderscore}{\kern0pt}SS{\isachardoublequoteclose}
}

\DefineSnippet{ss-indices-def}{
    \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}subset{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}indices\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ finite\ S\ {\isasymand}\ S\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ S\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ then\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ else\ {\isacharbraceleft}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}card\ S{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymexists}S{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ S{\isachardot}{\kern0pt}\ sum\ w\ S{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}
}

\DefineSnippet{ss-indices-red}{
    \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}generate{\isacharunderscore}{\kern0pt}func\ S\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}SOME\ f{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ S\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ then\ bij{\isacharunderscore}{\kern0pt}betw\ f\ S\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ else\ bij{\isacharunderscore}{\kern0pt}betw\ f\ S\ {\isacharbraceleft}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}card\ S{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ if\ finite\ S\ then\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}generate{\isacharunderscore}{\kern0pt}func\ S{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ S{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ w\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}into\ S\ {\isacharparenleft}{\kern0pt}generate{\isacharunderscore}{\kern0pt}func\ S{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline 
\isanewline 
\isacommand{theorem}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}reduction{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}reduction\ ss{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices\ subset{\isacharunderscore}{\kern0pt}sum\ subset{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}indices{\isachardoublequoteclose}
}

\DefineSnippet{ss-list}{
    \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}subset{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}indices\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ finite\ S\ {\isasymand}\ S\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ S\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ then\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ else\ {\isacharbraceleft}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}card\ S{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymexists}S{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ S{\isachardot}{\kern0pt}\ sum\ w\ S{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ set\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymRightarrow}\ nat{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ nat\ list\ {\isasymtimes}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
{\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ if\ {\isacharparenleft}{\kern0pt}finite\ S\ {\isasymand}\ S\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}card\ S{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ then\ {\isacharparenleft}{\kern0pt}map\ w\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ S{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}reduction{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}reduction\ ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list\ subset{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}indices\ subset{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list{\isachardoublequoteclose}
}

\DefineSnippet{ss-indices-poly}{
    \isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}alg\ {\isasymequiv}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ b\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}check{\isacharunderscore}{\kern0pt}finiteness\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ if\ b\ \isanewline
\ \ \ \ then\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ S{\isacharprime}{\kern0pt}\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}mapping{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ w{\isacharprime}{\kern0pt}\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}updating{\isacharunderscore}{\kern0pt}the{\isacharunderscore}{\kern0pt}weighting\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ RETURNT\ {\isacharparenleft}{\kern0pt}S{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ w{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}\ \isanewline
\ \ \ \ else\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ RETURNT\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}space\ n\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}time\ n\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}polyred{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}ispolyred\ ss{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}alg\ subset{\isacharunderscore}{\kern0pt}sum\ subset{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}indices\ size{\isacharunderscore}{\kern0pt}SS\ size{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices{\isachardoublequoteclose}
}

\DefineSnippet{ss-list-poly}{
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}alg\ {\isasymequiv}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
    \ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
    \ \ \ \ b\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}check{\isacharunderscore}{\kern0pt}finiteness{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
    \ \ \ \ if\ b\isanewline
    \ \ \ \ then\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
    \ \ \ \ \ \ as\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}mapping{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ w{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
    \ \ \ \ \ \ s\ {\isasymleftarrow}\ mop{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}int\ B{\isacharsemicolon}{\kern0pt}\isanewline
    \ \ \ \ \ \ RETURNT\ {\isacharparenleft}{\kern0pt}as{\isacharcomma}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\isanewline
    \ \ \ \ {\isacharbraceright}{\kern0pt}\isanewline
    \ \ \ \ else\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
    \ \ \ \ \ \ RETURNT\ {\isacharparenleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
    \ \ \ \ {\isacharbraceright}{\kern0pt}\isanewline
    \ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
    \isanewline
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}space\ n\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ n{\isachardoublequoteclose}\isanewline
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}time\ n\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
    \isanewline
    \isacommand{theorem}\isamarkupfalse%
    \ ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}polyred{\isacharcolon}{\kern0pt}\isanewline
    \ \ {\isachardoublequoteopen}ispolyred\ ss{\isacharunderscore}{\kern0pt}indices{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}alg\ subset{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}indices\ subset{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ size{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}indices\ size{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list{\isachardoublequoteclose}
}

\DefineSnippet{part-def}{
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}part\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}as{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat\ list{\isachardot}{\kern0pt}\ {\isasymexists}xs{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ xs{\isachardot}{\kern0pt}\ xs{\isacharbang}{\kern0pt}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ length\ as\ {\isacharequal}{\kern0pt}\ length\ xs\ \isanewline
    \ \ {\isasymand}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ length\ as{\isachardot}{\kern0pt}\ as\ {\isacharbang}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ xs\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}\ {\isasymSum}i\ {\isacharless}{\kern0pt}\ length\ as{\isachardot}{\kern0pt}\ as\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
    \isanewline
    \isacommand{definition}\isamarkupfalse%
    \ {\isachardoublequoteopen}part{\isacharunderscore}{\kern0pt}alter\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}as{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat\ list{\isachardot}{\kern0pt}\ {\isasymexists}xs{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ xs{\isachardot}{\kern0pt}\ xs{\isacharbang}{\kern0pt}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ length\ as\ {\isacharequal}{\kern0pt}\ length\ xs\ \isanewline
    \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ length\ as{\isachardot}{\kern0pt}\ as\ {\isacharbang}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ xs\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ length\ as{\isachardot}{\kern0pt}\ as\ {\isacharbang}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ xs\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
    \isanewline
    \isacommand{theorem}\isamarkupfalse%
    \ part{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}part{\isacharunderscore}{\kern0pt}alter{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}part\ {\isacharequal}{\kern0pt}\ part{\isacharunderscore}{\kern0pt}alter{\isachardoublequoteclose}
    \isanewline \isanewline 
    \isacommand{theorem}\isamarkupfalse%
    \ is{\isacharunderscore}{\kern0pt}reduction{\isacharunderscore}{\kern0pt}ss{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}part{\isacharcolon}{\kern0pt}\isanewline
    {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}reduction\ ss{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}part\ subset{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ part{\isachardoublequoteclose}\
}
\DefineSnippet{part-aux1}{
    \isacommand{lemma}\isamarkupfalse%
\ sum{\isacharunderscore}{\kern0pt}binary{\isacharunderscore}{\kern0pt}part{\isacharcolon}{\kern0pt}\ \isanewline
\isakeyword{assumes}\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ xs{\isachardot}{\kern0pt}\ xs{\isacharbang}{\kern0pt}i\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isasymor}\ xs{\isacharbang}{\kern0pt}i\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}length\ as\ {\isacharequal}{\kern0pt}\ length\ xs{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ length\ as{\isachardot}{\kern0pt}\ as\ {\isacharbang}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ xs\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ length\ as{\isachardot}{\kern0pt}\ as\ {\isacharbang}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ xs\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ length\ as{\isachardot}{\kern0pt}\ as\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}
}